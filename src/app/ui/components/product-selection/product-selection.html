<p-card header="Selección de Producto y Opciones" class="shadow-md">
  <div class="p-fluid grid p-formgrid">
    <div class="col-12 md:col-6">
      <div class="card flex justify-center">
        <p-selectbutton [options]="productsTypeOptions" optionLabel="label" optionValue="value" autofocus="true" />
      </div>
      <div class="field mb-4">
        <label for="productSelect" class="block text-900 font-medium mb-2">Producto</label>
        <p-dropdown id="productSelect" [options]="products" [(ngModel)]="selectedProduct" optionLabel="name"
          placeholder="Seleccione un producto" (onChange)="onProductChange()" [filter]="true"></p-dropdown>
      </div>
    </div>

    <div class="col-12 md:col-6">
      <div class="field mb-4">
        <label for="quantityInput" class="block text-900 font-medium mb-2">Cantidad</label>
        <p-inputNumber id="quantityInput" [(ngModel)]="quantity" [showButtons]="true" [min]="1"
          (onInput)="onQuantityChange()"></p-inputNumber>
      </div>
    </div>

    <div class="col-12" *ngIf="selectedProduct && extraOptions.length > 0">
      <p-card header="Opciones Extra" [style]="{'margin-bottom': '20px'}">
        <div class="flex flex-wrap gap-3">
          <div *ngFor="let option of extraOptions" class="field-checkbox">
            <p-checkbox [inputId]="'option-' + option.id" [value]="option" [(ngModel)]="selectedExtraOptions"
              (onChange)="onOptionToggle()">
            </p-checkbox>
            <label [for]="'option-' + option.id">{{ option.description }} (+S/ {{ option.baseCost |
              number:'1.2-2' }})</label>
          </div>
        </div>
      </p-card>
    </div>

    <div class="col-12">
      <div class="flex justify-content-between align-items-center mb-4">
        <span class="text-xl font-bold">Precio Unitario:</span>
        <span class="text-xl text-primary font-bold">S/ {{ calculatedUnitPrice | number:'1.2-2' }}</span>
      </div>
      <div class="flex justify-content-between align-items-center mb-4">
        <span class="text-2xl font-bold">Precio Total Item:</span>
        <span class="text-2xl text-primary font-bold">S/ {{ calculatedTotalPrice | number:'1.2-2' }}</span>
      </div>
    </div>

    <div class="col-12 text-right">
      <p-button label="Añadir al Carrito" icon="pi pi-cart-plus" styleClass="p-button-primary" (onClick)="addToCart()"
        [disabled]="!selectedProduct || quantity <= 0 || calculatedTotalPrice <= 0"></p-button>
    </div>
  </div>
</p-card>